<section class="content-header">
  <h1>
    Avaliação
  </h1>
  <ol class="breadcrumb">
    <li>
      <a href="#">
        <i class="fa fa-home"></i> Home</a>
    </li>
    <li class="active">Avaliação</li>
  </ol>
</section>
<section class="content">
  <div class="row">
    <div class="box-body">
      <div class="col-xs-12">
        <div class="box">
          <div class="box-header">
            <h3 class="box-title">Avaliações Registradas</h3>
            <div class="box-tools">
              <a *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'" routerLink="/avaliacao/novo" class="btn btn-sm pull-left btn-flat bg-purple margin-right-10">
                <i class="fa fa-plus"></i>
                <b>Nova Avaliação</b>
              </a>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <!-- <div class="alert alert-warning alert-dismissible" *ngIf="avaliacaoCarregada">
              <h4>
                <i class="icon fa fa-warning"></i> Alerta!</h4>
              Nenhuma avaliação existente no momento.
            </div> -->
            <table class="table table-condensed" *ngIf="avaliacaoDetalhe.length > 0">
              <tr>
                <td>
                  <div class="box-header with-border">
                    <h3 class="box-title">&nbsp;&nbsp;#&nbsp;Divisão&nbsp;&nbsp;Colaborador</h3>
                  </div>
                </td>
              </tr>
              <tr *ngFor="let aval of avaliacaoDetalhe; index as i" [attr.data-index]="i">
                <td>
                  <div class="box-body table-responsive no-padding">
                    <div class="box box-default collapsed-box">
                      <div class="box-header with-border">
                        <label>
                          &nbsp;&nbsp; {{ i+1 }} &nbsp; {{ aval.listGroup.sigla_divisao }} &nbsp;&nbsp;&nbsp;&nbsp; {{ aval.listGroup.no_colaborador
                          }}
                        </label>
                        <div class="box-tools pull-right">
                          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip">
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                      <div class="box-body">
                        <table id="" class="table">
                          <tr *ngIf="avaliacaoDetalhe.length == 0">
                            <td colspan="10">
                              <div class="alert alert-warning alert-dismissible">
                                <h4>
                                  <i class="icon fa fa-warning"></i> Alerta!</h4>
                                Não existem avaliações para este usuário!
                              </div>
                            </td>
                          </tr>
                          <tr *ngFor="let items of aval.listDetalhe; let j = index; ">
                            <td>
                              <table class="table table-striped" border="0">
                                <tr>
                                  <th>
                                    <p class="text-center">
                                      {{ i+1 }}.{{ j+1 }}
                                    </p>
                                  </th>
                                  <td>Data: {{ items.dt_resultado }}</td>
                                  <td>
                                    <table id="" class="table table-striped" border="0">
                                      <tr>
                                        <th>
                                          <p class="text-center">
                                            <span class="badge bg-light-blue">&nbsp;&nbsp;&nbsp;FCT Atual&nbsp;&nbsp;&nbsp;</span>
                                          </p>
                                        </th>
                                        <th>
                                          <p class="text-center">
                                            <span class="badge bg-light-blue">&nbsp;&nbsp;&nbsp;Pontuação Atual&nbsp;&nbsp;&nbsp;</span>
                                          </p>
                                        </th>
                                        <th>
                                          <p class="text-center">
                                            <span class="badge bg-red">&nbsp;&nbsp;&nbsp;Diferença&nbsp;&nbsp;&nbsp;</span>
                                          </p>
                                        </th>
                                        <th>
                                          <p class="text-center">
                                            <span class="badge bg-green">&nbsp;&nbsp;&nbsp;Pontuação Avaliação&nbsp;&nbsp;&nbsp;</span>
                                          </p>
                                        </th>
                                        <th *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">
                                          <p class="text-center">
                                            <span class="badge bg-green">&nbsp;&nbsp;&nbsp;FCT Avaliação&nbsp;&nbsp;&nbsp;</span>
                                          </p>
                                        </th>
                                        <th></th>
                                        <th></th>
                                      </tr>
                                      <tr>
                                        <td>
                                          <p class="text-center">{{ items.fct_atual }}</p>
                                        </td>
                                        <td>
                                          <p class="text-center">{{ ((items.pontuacao - items.ajuste) + (2 * items.ajuste)).toFixed(2) }}</p>
                                        </td>
                                        <td>
                                          <p class="text-center">{{ (items.ajuste * (-1)).toFixed(2) }}</p>
                                        </td>
                                        <td>
                                          <p class="text-center">{{ items.pontuacao.toFixed(2) }}</p>
                                        </td>
                                        <td *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">
                                          <p class="text-center">{{ items.fct_ideal }}</p>
                                        </td>
                                        <!-- <td>
                                            <a class="btn  btn-xs bg-blue btn-flat">
                                               <i class="fa fa-pencil"></i>
                                            </a>
                                        </td> -->
                                        <td>
                                          <p class="text-center">
                                            <a class="btn  btn-xs bg-blue btn-flat" [routerLink]="['/resultadoAvaliacao/', items.id_resultado]">
                                              <i class="fa fa-search"></i>
                                            </a>
                                          </p>
                                        </td>
                                        <td *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">
                                          <p class="text-center">
                                            <button type="button" class="btn  btn-xs bg-red btn-flat" (click)="deleteAvaliacao(items, aval.listDetalhe)">
                                              <i class="fa fa-remove"></i>
                                            </button>
                                          </p>
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                  <tr>
                              </table>
                            </td>
                            </tr>
                        </table>
                      </div>
                    </div>
                  </div>
                </td>
                </tr>
            </table>
          </div>
        </div>
      </div>
      <!-- /.box-body -->
    </div>
    <!-- /.box -->
  </div>
</section>
