<section class="content-header">
  <h1>
    Avaliação
  </h1>
  <ol class="breadcrumb">
    <li>
      <a href="#">
        <i class="fa fa-home"></i> Home</a>
    </li>
    <li class="active">Avaliação</li>
  </ol>
</section>
<section class="content">
  <div class="row">
    <div class="box-body">
      <div class="col-xs-12">
        <div class="box">
          <div class="box-header">
            <h3 class="box-title">Avaliações Registradas</h3>
            <div class="box-tools">
              <a *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'" routerLink="/avaliacao/novo" class="btn btn-sm pull-left btn-flat bg-purple margin-right-10">
                <i class="fa fa-plus"></i>
                <b>Nova Avaliação</b>
              </a>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <!-- {{ avaliacaoDetalhe.length | json }} -->
            <div class="alert alert-warning alert-dismissible" *ngIf="avaliacaoDetalhe.length == 0">
              <h4>
                <i class="icon fa fa-warning"></i> Alerta!</h4>
              Nenhuma avaliação existente no momento.
            </div>
            <table class="table table-condensed" *ngIf="avaliacaoDetalhe.length > 0">
              <tr>
                <td>
                  <div class="box-header with-border">
                    <h3 class="box-title">&nbsp;&nbsp;#&nbsp;Divisão&nbsp;&nbsp;Colaborador</h3>
                  </div>
                </td>
              </tr>
              <tr *ngFor="let aval of avaliacaoDetalhe; index as i" [attr.data-index]="i">
                <td>
                  <div class="box-body table-responsive no-padding">
                    <div class="box box-default collapsed-box">
                      <div class="box-header with-border">
                        <label>
                          &nbsp;&nbsp; {{ i+1 }} &nbsp; {{ aval.listGroup.sigla_divisao }} &nbsp;&nbsp;&nbsp;&nbsp; {{ aval.listGroup.no_colaborador
                          }}
                        </label>
                        <div class="box-tools pull-right">
                          <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip">
                            <i class="fa fa-plus"></i>
                          </button>
                        </div>
                      </div>
                      <div class="box-body">
                        <table id="" class="table table-striped">
                          <tr>
                            <th>#</th>
                            <th>Data da Avaliação</th>
                            <th>Pontuação</th>
                            <th>Ajuste</th>
                            <th>Pontuação Ideal</th>
                            <th>Diferença</th>
                            <th>FCT Atual</th>
                            <th *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">FCT Pela Pontuação</th>
                            <th></th>
                            <th *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'"></th>
                          </tr>
                          <tr *ngIf="avaliacaoDetalhe.length == 0">
                            <td colspan="10">
                              <div class="alert alert-warning alert-dismissible">
                                <h4>
                                  <i class="icon fa fa-warning"></i> Alerta!</h4>
                                Não existem avaliações para este usuário!
                              </div>
                            </td>
                          </tr>
                          <tr *ngFor="let items of aval.listDetalhe; let i = index">
                            <td>{{ i+1 }}</td>
                            <td>{{ items.dt_resultado }}</td>
                            <td>{{ items.pontuacao.toFixed(2) }}</td>
                            <td>{{ items.ajuste.toFixed(2) }}</td>
                            <td>{{ ((items.pontuacao - items.ajuste) + (2 * items.ajuste)).toFixed(2) }}</td>
                            <td>
                              <span class="badge bg-green">{{ ((items.ajuste / items.pontuacao) * 100).toFixed(2) }}%</span>
                            </td>
                            <td>{{ items.fct_atual }}</td>
                            <td *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">{{ items.fct_ideal }}</td>
                            <!-- <td>
                              <a class="btn  btn-xs bg-blue btn-flat">
                                <i class="fa fa-pencil"></i>
                              </a>
                            </td> -->
                            <td>
                              <a class="btn  btn-xs bg-blue btn-flat" [routerLink]="['/resultadoAvaliacao/', items.id_resultado]">
                                <i class="fa fa-search"></i>
                              </a>
                            </td>
                            <td *ngIf="user().ds_perfil == 'ADMINISTRADOR' || user().ds_perfil == 'LIDER'">
                              <button type="button" class="btn  btn-xs bg-red btn-flat" (click)="deleteAvaliacao(items, aval.listDetalhe)">
                                <i class="fa fa-remove"></i>
                              </button>
                            </td>
                          </tr>
                        </table>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div>
      <!-- /.box-body -->
    </div>
    <!-- /.box -->
  </div>
</section>
